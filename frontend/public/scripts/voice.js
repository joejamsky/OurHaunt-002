const voiceForm=document.getElementById("voice-form"),voiceFormInput=document.getElementById("voice-input"),voiceFormMicButton=document.getElementById("voice-mic-button"),voiceRequest=document.getElementById("voice-request");function handleTextArray(e){return 1===e.length?e[0]:e.slice(0,-1).join(", ")+", and "+e[e.length-1]}var fontarr=["font-family: courier new, sans-serif","font-family: comic sans, sans-serif","font-family: arial black, sans-serif"];function fontRandomizer(e){return'<span style="'+fontarr[Math.floor((3*Math.random()+1)%3)]+'">'+e+"</span>"}function typeWriterEffect(e,t="voice-response",o=250){const a=document.getElementById(t);let r="",i=0;!function t(){i<e.length&&(r+=e.charAt(i),a.innerText=r,i++,setTimeout(t,o))}()}function checkInputPhrase(e){switch(e){case"how old are you":case"how young are you":case"what is your age":case"age":typeWriterEffect(GLOBAL_ENTITY.Age);break;case"what's your name":case"what is your name":case"what can i call you":case"can you give me your name":case"name":typeWriterEffect(GLOBAL_ENTITY.Name);break;case"what is your birth date":case"what is your birthday":case"when is your birth date":case"when is your birthday":case"what day were you born":case"when were you born":case"birth date":case"birthday":typeWriterEffect(`I was born ${GLOBAL_ENTITY.Birthdate.month}/${GLOBAL_ENTITY.Birthdate.day}/${GLOBAL_ENTITY.Birthdate.year}.`);break;case"what is your death date":case"what is your death day":case"when is your death date":case"when is your death day":case"death date":case"death day":typeWriterEffect(`I died ${GLOBAL_ENTITY.Deathdate.month}/${GLOBAL_ENTITY.Deathdate.day}/${GLOBAL_ENTITY.Deathdate.year}.`);break;case"how did you die":case"what was your cause of death":case"cause of death":typeWriterEffect(GLOBAL_ENTITY.CauseOfDeath);break;case"what do you want":case"why are you here":case"what is your motive":case"how can i help":typeWriterEffect(GLOBAL_ENTITY.Intention);break;case"what do you like to do":case"what did you like to do":case"hobbies":typeWriterEffect(`I liked ${handleTextArray(GLOBAL_ENTITY.Hobbies)}.`);break;case"are you telling the truth":GLOBAL_ENTITY.Ordered,typeWriterEffect("Yes.");break;case"do you have a mother":case"where is your mother":case"mother":GLOBAL_ENTITY.Relationships.Mom?typeWriterEffect("I have a mother but I don't know where she is"):typeWriterEffect("I don't have a mother");break;case"what was your job":case"job":case"occupation":typeWriterEffect(GLOBAL_ENTITY.Profession);break;case"were you rich":case"were you poor":case"how much money did you make":case"how much were you worth":case"income":typeWriterEffect(GLOBAL_ENTITY.Income);break;case"what is your favorite food":case"do you have a favorite food":typeWriterEffect(`I liked ${handleTextArray(GLOBAL_ENTITY.Favorites.Food)}.`);break;case"what is your favorite drink":case"do you have a favorite drink":typeWriterEffect(`I liked ${handleTextArray(GLOBAL_ENTITY.Favorites.Drink)}.`);break;case"what is your favorite band":case"do you have a favorite band":case"who is your favorite musician":case"do you have a favorite musician":typeWriterEffect(`I liked ${handleTextArray(GLOBAL_ENTITY.Favorites.Music)}.`);break;case"what is your favorite book":case"do you have a favorite book":typeWriterEffect(`I liked ${handleTextArray(GLOBAL_ENTITY.Favorites.Literature)}.`);break;case"what is your favorite film":case"do you have a favorite film":case"what is your favorite clothing":case"do you have a favorite clothing":case"do you have a favorite outfit":case"do you have a favorite piece of clothing":case"do you have a favorite article of clothing":typeWriterEffect(`I liked ${handleTextArray(GLOBAL_ENTITY.Favorites.Film)}.`);break;case"what is your favorite color":case"do you have a favorite color":typeWriterEffect(`I liked ${handleTextArray(GLOBAL_ENTITY.Favorites.Color)}.`);break;default:typeWriterEffect("...?"),addHostility()}}const SpeechRecognition=window.SpeechRecognition||window.webkitSpeechRecognition;async function fetchAndType(e){console.log("fetch and type message",e);try{typeWriterEffect(await getChatGPTMessage(e))}catch(e){console.error("Error:",e)}}async function getChatGPTMessage(e="This is a test voice message, say 1234 if you get it"){try{const t=await fetch("/.netlify/functions/chatgpt/chatgpt",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:e})});console.log("Message to GPT-3:",e);const o=await t.json();console.log("data from GPT-3",o);const a=o.response.choices[0].message.content;return console.log("Message from GPT-3:",a),a}catch(e){console.error("Netlify Error:",e)}}if(SpeechRecognition){console.log("Speech recognition connected.");const e=new SpeechRecognition;e.continuous=!0;const t=voiceFormMicButton.firstElementChild,o=document.getElementsByClassName("voice-light-bulb")[0];function micBtnClick(){t.classList.contains("fa-microphone")?e.start():e.stop()}function startSpeechRecognition(e){t.classList.remove("fa-microphone"),t.classList.add("fa-ear-listen"),o.classList.remove("voice-light-off"),voiceFormInput.focus(),console.log("Voice activated, SPEAK")}var transcript;function endSpeechRecognition(){t.classList.remove("fa-ear-listen"),t.classList.add("fa-microphone"),o.classList.add("voice-light-off"),voiceFormInput.focus(),console.log("Speech recognition service disconnected"),fetchAndType(transcript),document.getElementById("voice-request").innerText=""}function resultOfSpeechRecognition(t){const o=t.resultIndex;"close channel"===(transcript=t.results[o][0].transcript).toLowerCase().trim()?e.stop():voiceFormInput.value=transcript}voiceFormMicButton.addEventListener("click",micBtnClick),e.addEventListener("start",startSpeechRecognition),e.addEventListener("end",endSpeechRecognition),e.onresult=function(e){let t="",o="";for(let a=e.resultIndex;a<e.results.length;a++){const r=e.results[a][0].transcript;e.results[a].isFinal?t+=r+" ":o+=r}console.log("interimTranscript",o),console.log("finalTranscript",t),typeWriterEffect(t,"voice-request",50)},e.addEventListener("result",resultOfSpeechRecognition)}else console.log("Your Browser does not support speech Recognition"),alert("Your Browser does not support Speech Recognition");